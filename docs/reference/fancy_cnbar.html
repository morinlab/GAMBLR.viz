<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Copy Number states barplot — fancy_cnbar • GAMBLR.viz</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Copy Number states barplot — fancy_cnbar"><meta name="description" content="Plot sample-specific CN states and affected bases for each segment"><meta property="og:description" content="Plot sample-specific CN states and affected bases for each segment"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GAMBLR.viz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/why.html">GAMBLR.viz</a></li>
    <li><a class="dropdown-item" href="../articles/install.html"></a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/recap_figures.html">Reproducing figures from GAMBL papers</a></li>
    <li><a class="dropdown-item" href="../articles/forestplot.html">Easy forest plots</a></li>
    <li><a class="dropdown-item" href="../articles/CopyNumberHeatmap.html">Visualizing copy number data as heatmaps</a></li>
    <li><a class="dropdown-item" href="../articles/data_q.html">Exploring data quality</a></li>
    <li><a class="dropdown-item" href="../articles/oncoplot.html">Upgrade your Oncoplots</a></li>
    <li><a class="dropdown-item" href="../articles/getting_started.html">Metadata and GAMBLR colours</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Help</h6></li>
    <li><a class="dropdown-item" href="../articles/faq.html">Frequently Asked Qestions</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Copy Number states barplot</h1>

      <div class="d-none name"><code>fancy_cnbar.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot sample-specific CN states and affected bases for each segment</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fancy_cnbar</span><span class="op">(</span></span>
<span>  <span class="va">this_sample_id</span>,</span>
<span>  <span class="va">seg_data</span>,</span>
<span>  seg_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chrom_col <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  start_col <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  end_col <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  cn_col <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  plot_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">this_sample_id</span><span class="op">)</span>,</span>
<span>  plot_subtitle <span class="op">=</span></span>
<span>    <span class="st">"n CNV Segments (barplots, left y-axis), n Affected bases for each CN state"</span>,</span>
<span>  chr_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  include_cn2 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  this_seq_type <span class="op">=</span> <span class="st">"genome"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-this-sample-id">this_sample_id<a class="anchor" aria-label="anchor" href="#arg-this-sample-id"></a></dt>
<dd><p>Sample to be plotted.</p></dd>


<dt id="arg-seg-data">seg_data<a class="anchor" aria-label="anchor" href="#arg-seg-data"></a></dt>
<dd><p>Optional parameter with copy number df already loaded into R.</p></dd>


<dt id="arg-seg-path">seg_path<a class="anchor" aria-label="anchor" href="#arg-seg-path"></a></dt>
<dd><p>Optional parameter with path to external cn file.</p></dd>


<dt id="arg-chrom-col">chrom_col<a class="anchor" aria-label="anchor" href="#arg-chrom-col"></a></dt>
<dd><p>Index of column with chromosome annotations (to be used with either maf_data or maf_path).</p></dd>


<dt id="arg-start-col">start_col<a class="anchor" aria-label="anchor" href="#arg-start-col"></a></dt>
<dd><p>Index of column with copy number start coordinates (to be used with either maf_data or maf_path).</p></dd>


<dt id="arg-end-col">end_col<a class="anchor" aria-label="anchor" href="#arg-end-col"></a></dt>
<dd><p>Index of column with copy number end coordinates (to be used with either maf_data or maf_path).</p></dd>


<dt id="arg-cn-col">cn_col<a class="anchor" aria-label="anchor" href="#arg-cn-col"></a></dt>
<dd><p>Index of column holding copy number information (to be used with either maf_data or maf_path).</p></dd>


<dt id="arg-plot-title">plot_title<a class="anchor" aria-label="anchor" href="#arg-plot-title"></a></dt>
<dd><p>Title of plot (default to sample ID).</p></dd>


<dt id="arg-plot-subtitle">plot_subtitle<a class="anchor" aria-label="anchor" href="#arg-plot-subtitle"></a></dt>
<dd><p>Subtitle for created plot.</p></dd>


<dt id="arg-chr-select">chr_select<a class="anchor" aria-label="anchor" href="#arg-chr-select"></a></dt>
<dd><p>Vector of chromosomes to be included in plot, defaults to autosomes.</p></dd>


<dt id="arg-cutoff">cutoff<a class="anchor" aria-label="anchor" href="#arg-cutoff"></a></dt>
<dd><p>Set threshold for maximum CN state to be retrieved.</p></dd>


<dt id="arg-include-cn-">include_cn2<a class="anchor" aria-label="anchor" href="#arg-include-cn-"></a></dt>
<dd><p>Optional boolean statement for including CN = 2 states in plot.</p></dd>


<dt id="arg-this-seq-type">this_seq_type<a class="anchor" aria-label="anchor" href="#arg-this-seq-type"></a></dt>
<dd><p>Seq type for returned CN segments. One of "genome" (default) or "capture".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A plot as a ggplot object (grob).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>`fancy_cnbar` visualizes copy number (CN) states on sample-level. Similarly to other fancy_x_plots this function
accepts either a sample ID, for which the function will get copy number states with [GAMBLR::get_sample_cn_segments]. The function
can also accept an already loaded seg file given to the `seg_data` parameter. It can also load a seg file with the `seg_path`
parameter. If the user calls either `seg_data` or `seg_path`, there are a collection of parameters available for specifying
the relevant columns in the given data frame (`chrom_col`, `starat_col`, `end_col`, `cn_col`). It is also possible to
restrict the returned plot to any given chromosome. This is done with the `chr_select` parameter (default is all autosomes).
For further control of the returned plot, it is also possible to set the threshold for maximum CN states to be returned (default is 15).
With `include_cn2` (Boolean) the user can control if CN segments = 2 should be added to the plot, default is TRUE.
The user can also control the annotations of the returned plot with `plot_title` and `plot_subtitle`. Lastly,
This function also computes the number of affected bases for each copy number state and plots these values on a secondary y-axis (right),
useful for overviewing the extent of each copy number state, in the context of the full genome.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GAMBLR.data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Return a plot for one sample, with default parameters.</span></span></span>
<span class="r-in"><span><span class="fu">fancy_cnbar</span><span class="op">(</span>this_sample_id <span class="op">=</span> <span class="st">"DOHH-2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ryan Morin, Kostiantyn Dreval, Laura Hilton, Adam Mattsson, Vladimir Souza.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

