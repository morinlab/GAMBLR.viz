<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Forest Plot. — prettyForestPlot • GAMBLR.viz</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Forest Plot. — prettyForestPlot"><meta name="description" content="Create a forest plot comparing mutation frequencies
for a set of genes between two groups."><meta property="og:description" content="Create a forest plot comparing mutation frequencies
for a set of genes between two groups."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GAMBLR.viz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/why.html">GAMBLR.viz</a></li>
    <li><a class="dropdown-item" href="../articles/install.html"></a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/recap_figures.html">Reproducing figures from GAMBL papers</a></li>
    <li><a class="dropdown-item" href="../articles/forestplot.html">Easy forest plots</a></li>
    <li><a class="dropdown-item" href="../articles/CopyNumberHeatmap.html">Visualizing copy number data as heatmaps</a></li>
    <li><a class="dropdown-item" href="../articles/data_q.html">Exploring data quality</a></li>
    <li><a class="dropdown-item" href="../articles/oncoplot.html">Upgrade your Oncoplots</a></li>
    <li><a class="dropdown-item" href="../articles/getting_started.html">Metadata and GAMBLR colours</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Help</h6></li>
    <li><a class="dropdown-item" href="../articles/faq.html">Frequently Asked Qestions</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Forest Plot.</h1>

      <div class="d-none name"><code>prettyForestPlot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a forest plot comparing mutation frequencies
for a set of genes between two groups.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prettyForestPlot</span><span class="op">(</span></span>
<span>  <span class="va">maf</span>,</span>
<span>  <span class="va">mutmat</span>,</span>
<span>  <span class="va">metadata</span>,</span>
<span>  <span class="va">genes</span>,</span>
<span>  keepGeneOrder <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  min_mutations <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">comparison_column</span>,</span>
<span>  rm_na_samples <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  comparison_values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  separate_hotspots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  comparison_name <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  custom_colours <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  custom_labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max_q <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-maf">maf<a class="anchor" aria-label="anchor" href="#arg-maf"></a></dt>
<dd><p>A maf data frame. Minimum required columns are Hugo_Symbol
and Tumor_Sample_Barcode.</p></dd>


<dt id="arg-mutmat">mutmat<a class="anchor" aria-label="anchor" href="#arg-mutmat"></a></dt>
<dd><p>Optional argument for binary mutation matrix. If not
supplied, function will generate this matrix from the file used in
argument "maf".</p></dd>


<dt id="arg-metadata">metadata<a class="anchor" aria-label="anchor" href="#arg-metadata"></a></dt>
<dd><p>Metadata for the comparisons. Minimum required
columns are Tumor_Sample_Barcode and the column assigning each case
to one of two groups.</p></dd>


<dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>An optional vector of genes to restrict your plot to.
If no gene-list is supplied, the function will extract all mutated
genes from the incoming maf. See min_mutations parameter for more info.</p></dd>


<dt id="arg-keepgeneorder">keepGeneOrder<a class="anchor" aria-label="anchor" href="#arg-keepgeneorder"></a></dt>
<dd><p>Set to TRUE if you want to preserve the gene
order specified.</p></dd>


<dt id="arg-min-mutations">min_mutations<a class="anchor" aria-label="anchor" href="#arg-min-mutations"></a></dt>
<dd><p>Optional parameter for when no `genes` is provided.
This parameter ensures only genes with n mutations are kept in `genes`.
Default value is 1, this means all genes in the incoming maf will be plotted.</p></dd>


<dt id="arg-comparison-column">comparison_column<a class="anchor" aria-label="anchor" href="#arg-comparison-column"></a></dt>
<dd><p>Mandatory: the name of the metadata column
containing the comparison values.</p></dd>


<dt id="arg-rm-na-samples">rm_na_samples<a class="anchor" aria-label="anchor" href="#arg-rm-na-samples"></a></dt>
<dd><p>Set to TRUE to remove 0 mutation samples.
Default is FALSE.</p></dd>


<dt id="arg-comparison-values">comparison_values<a class="anchor" aria-label="anchor" href="#arg-comparison-values"></a></dt>
<dd><p>Optional: If the comparison column contains
more than two values or is not a factor, specify a character vector
of length two in the order you would like the factor levels to be set,
reference group first.</p></dd>


<dt id="arg-separate-hotspots">separate_hotspots<a class="anchor" aria-label="anchor" href="#arg-separate-hotspots"></a></dt>
<dd><p>Optional: If you would like to treat hotspots
separately from other mutations in any gene. Requires that the maf file
is annotated with [GAMBLR::annotate_hotspots].</p></dd>


<dt id="arg-comparison-name">comparison_name<a class="anchor" aria-label="anchor" href="#arg-comparison-name"></a></dt>
<dd><p>Optional: Specify the legend title if different
from the comparison column name.</p></dd>


<dt id="arg-custom-colours">custom_colours<a class="anchor" aria-label="anchor" href="#arg-custom-colours"></a></dt>
<dd><p>Optional: Specify a named vector of colours that
match the values in the comparison column.</p></dd>


<dt id="arg-custom-labels">custom_labels<a class="anchor" aria-label="anchor" href="#arg-custom-labels"></a></dt>
<dd><p>Optional: Specify custom labels for the legend
categories. Must be in the same order as comparison_values.</p></dd>


<dt id="arg-max-q">max_q<a class="anchor" aria-label="anchor" href="#arg-max-q"></a></dt>
<dd><p>cut off for q values to be filtered in fish test</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A convenient list containing all the data frames that were
created in making the plot, including the mutation matrix. It also
produces (and returns) ggplot object with a side-by-side forest plot
and bar plot showing mutation incidences across two groups.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function returns two types of plot (box plot and
forest plot), the user can either view them separately or arranged
on the same grob.
In addition this function also lets the user control the mutation
frequencies of the plotted genes.
If no `genes` is provided, this function auto-defaults to all genes
in the incoming maf.
The user can then control the minimum number of mutations requirement
for a gene to be included in the plot.
This is done with the `min_mutations` parameter.
For extended examples on how to use this function, refer to the example
inside the function documentation or the vignettes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GAMBLR.open</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">metadata</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/GAMBLR.open/man/get_gambl_metadata.html" class="external-link">get_gambl_metadata</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">this_meta</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">metadata</span>, <span class="va">pairing_status</span> <span class="op">==</span> <span class="st">"matched"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">this_meta</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">this_meta</span>, <span class="va">pathology</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FL"</span>, <span class="st">"DLBCL"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>            <span class="fu">check_and_clean_metadata</span><span class="op">(</span><span class="va">.</span>,duplicate_action<span class="op">=</span><span class="st">"keep_first"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">maf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/GAMBLR.open/man/get_coding_ssm.html" class="external-link">get_coding_ssm</a></span><span class="op">(</span>these_samples_metadata <span class="op">=</span> <span class="va">this_meta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">plots</span> <span class="op">=</span> <span class="fu">prettyForestPlot</span><span class="op">(</span>maf <span class="op">=</span> <span class="va">maf</span>,</span></span>
<span class="r-in"><span>                 metadata <span class="op">=</span> <span class="va">this_meta</span>,</span></span>
<span class="r-in"><span>                 genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ATP6V1B2"</span>,</span></span>
<span class="r-in"><span>                           <span class="st">"EZH2"</span>,</span></span>
<span class="r-in"><span>                           <span class="st">"TNFRSF14"</span>,</span></span>
<span class="r-in"><span>                           <span class="st">"RRAGC"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 comparison_column <span class="op">=</span> <span class="st">"pathology"</span>,</span></span>
<span class="r-in"><span>                 comparison_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DLBCL"</span>,</span></span>
<span class="r-in"><span>                                       <span class="st">"FL"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 separate_hotspots <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                 comparison_name <span class="op">=</span> <span class="st">"FL vs DLBCL"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plots</span><span class="op">$</span><span class="va">arranged</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="prettyForestPlot-1.png" alt="" width="864" height="778"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ryan Morin, Kostiantyn Dreval, Laura Hilton, Adam Mattsson, Vladimir Souza.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

