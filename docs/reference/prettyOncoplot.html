<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>PrettyOncoplot — prettyOncoplot • GAMBLR.viz</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="PrettyOncoplot — prettyOncoplot"><meta property="og:description" content="Create a highly customizable oncoplot."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GAMBLR.viz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>PrettyOncoplot</h1>
    
    <div class="hidden name"><code>prettyOncoplot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create a highly customizable oncoplot.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prettyOncoplot</span><span class="op">(</span></span>
<span>  <span class="va">maf_df</span>,</span>
<span>  <span class="va">gene_cnv_df</span>,</span>
<span>  <span class="va">binned_cnv_df</span>,</span>
<span>  <span class="va">genes</span>,</span>
<span>  include_noncoding <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keepGeneOrder <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keepSampleOrder <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  highlightHotspots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">these_samples_metadata</span>,</span>
<span>  <span class="va">genes_CN_thresh</span>,</span>
<span>  <span class="va">metadataColumns</span>,</span>
<span>  <span class="va">numericMetadataColumns</span>,</span>
<span>  expressionColumns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">numericMetadataMax</span>,</span>
<span>  <span class="va">sortByColumns</span>,</span>
<span>  <span class="va">sortByGenes</span>,</span>
<span>  arrange_descending <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  removeNonMutated <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  minMutationPercent <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  mutAlpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  recycleOncomatrix <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">splitColumnName</span>,</span>
<span>  <span class="va">splitGeneGroups</span>,</span>
<span>  showTumorSampleBarcode <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">groupNames</span>,</span>
<span>  <span class="va">hide_annotations</span>,</span>
<span>  hide_annotations_tracks <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  annotate_specific_genes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  this_forest_object <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  custom_colours <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hideTopBarplot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tally_all_mutations <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tally_all_mutations_max <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  hideSideBarplot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  box_col <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  annoAlpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  legend_direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend_position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>  legend_row <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  legend_col <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  metadataBarHeight <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  metadataBarFontsize <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  metadataSide <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>  legendFontSize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  fontSizeGene <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  annotation_row <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  annotation_col <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cluster_cols <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  clustering_distance_rows <span class="op">=</span> <span class="st">"binary"</span>,</span>
<span>  clustering_distance_cols <span class="op">=</span> <span class="st">"binary"</span>,</span>
<span>  <span class="va">split_rows_kmeans</span>,</span>
<span>  <span class="va">split_columns_kmeans</span>,</span>
<span>  dry_run <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  simplify_annotation <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  simplify_bg_colour <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  stacked <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_inputs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  gap <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  use_raster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_width <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_height <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show_any_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pct_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>  pctFontSize <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  row_names_side <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  show_pct <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  hide_annotation_name <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">cnv_df</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>maf_df</dt>
<dd><p>A maf as data frame containing the mutations you
want to plot.</p></dd>


<dt>gene_cnv_df</dt>
<dd><p>An optional data frame of CN status for
genes you want included (rows = sample_id,
columns = Hugo_Symbol)
See [GAMBLR.results::get_cnv_and_ssm_status] for more information.</p></dd>


<dt>binned_cnv_df</dt>
<dd><p>An optional data frame with the genome-wide CN
status of your samples in genomic bins
see [GAMBLR.utils::segmented_data_to_cn_matrix] for more information.</p></dd>


<dt>genes</dt>
<dd><p>An optional vector of genes to restrict
your plot to.</p></dd>


<dt>include_noncoding</dt>
<dd><p>List of non-coding regions to
be included, default is NULL. Specify like this:
include_noncoding=list("NFKBIZ" = c("3'UTR"), "HNRNPH1" = "Splice_Region")</p></dd>


<dt>keepGeneOrder</dt>
<dd><p>Set to TRUE if you want to preserve
the gene order specified.</p></dd>


<dt>keepSampleOrder</dt>
<dd><p>Set to TRUE if you want to preserve the sample order
specified. The default value is FALSE and respects all of the specified
ordering.</p></dd>


<dt>highlightHotspots</dt>
<dd><p>Set to TRUE to highlight hot spots.
Default is FALSE.</p></dd>


<dt>these_samples_metadata</dt>
<dd><p>Data frame containing metadata for your
samples.</p></dd>


<dt>genes_CN_thresh</dt>
<dd><p>A named vector specifying the genes whose copy
number status should be incorporated.
The names must be the gene symbols and the values should be integers that
indicate the maximum or minimum CN states to consider for that gene.
For example:
'REL'=4 would show CN 4 or higher; 'TP53'=1 would show
heterozygous and homozygous deletions
'BCL2'=3 would show single-copy gains or higher</p></dd>


<dt>metadataColumns</dt>
<dd><p>A vector containing the categorical
column names you want to plot below.</p></dd>


<dt>numericMetadataColumns</dt>
<dd><p>A vector containing the numeric columns you
want to plot below.</p></dd>


<dt>expressionColumns</dt>
<dd><p>Optional variable for retreiving expression
values for a specific gene(s).</p></dd>


<dt>numericMetadataMax</dt>
<dd><p>A numeric vector of cutoffs to apply to
numeric columns above.</p></dd>


<dt>sortByColumns</dt>
<dd><p>A vector containing the column names you want
to sort columns (patients) on.</p></dd>


<dt>arrange_descending</dt>
<dd><p>A Boolean parameter. Set to TRUE to sort
metadata in descending fashion. Default is FALSE.</p></dd>


<dt>removeNonMutated</dt>
<dd><p>Set to TRUE to drop unmutated cases.</p></dd>


<dt>minMutationPercent</dt>
<dd><p>Only genes mutated in more than
minMutationPercent % patients will be included.</p></dd>


<dt>mutAlpha</dt>
<dd><p>Optional alpha to apply to mutation colours.</p></dd>


<dt>recycleOncomatrix</dt>
<dd><p>Set to TRUE most of the time to
reuse the oncomatrix saved by maftools.</p></dd>


<dt>splitColumnName</dt>
<dd><p>Optional argument to indicate which metadata
column to split on.</p></dd>


<dt>splitGeneGroups</dt>
<dd><p>Split genes into groups for better seperation
(between different gene-groups) in prettyOncoplot.</p></dd>


<dt>showTumorSampleBarcode</dt>
<dd><p>Optional argument for showing tumor
barcode. Default is FALSE.</p></dd>


<dt>groupNames</dt>
<dd><p>optional vector of group names to be displayed
above heatmap. Should be the same length as the number of groups
that will be shown. Default is NULL (no labels).</p></dd>


<dt>hide_annotations</dt>
<dd><p>Hide annotations for specifc ashms. argument
takes a list with annotations.</p></dd>


<dt>hide_annotations_tracks</dt>
<dd><p>When hide_annotations is supplied
with a list of columns, this parameter can optionally also not display
those columns as the annotation track. Accepts TRUE and FALSE (default).</p></dd>


<dt>annotate_specific_genes</dt>
<dd><p>Optional argument, specifying whether
the features should be labelled according to their significance in
one of the pathologies. Default is FALSE (no annotation).</p></dd>


<dt>this_forest_object</dt>
<dd><p>If annotate_specific_genes is specified,
this arguments takes the output of GAMBLR::prettyForestPlot directly
to determine the annotations.</p></dd>


<dt>custom_colours</dt>
<dd><p>Provide named vector (or named list of vectors)
containing custom annotation colours if you do not want to use
standardized pallette.</p></dd>


<dt>hideTopBarplot</dt>
<dd><p>Optional argument for removing top bar plot.
Default value is TRUE.</p></dd>


<dt>tally_all_mutations</dt>
<dd><p>Optional argument. Set to TRUE to tally
all mutations. Default is FALSE.</p></dd>


<dt>tally_all_mutations_max</dt>
<dd><p>Optional argument. Default is 1000.</p></dd>


<dt>hideSideBarplot</dt>
<dd><p>Optional argument for removing side bar plot.
Default value is FALSE.</p></dd>


<dt>box_col</dt>
<dd><p>Colour of boxes for outlining mutations (can be
problematic with larger oncoprints).</p></dd>


<dt>annoAlpha</dt>
<dd><p>Optional alpha to apply to annotation colours.</p></dd>


<dt>legend_direction</dt>
<dd><p>Direction of legend, default is "horizontal".</p></dd>


<dt>ylim</dt>
<dd><p>Limit for y-axis.</p></dd>


<dt>legend_position</dt>
<dd><p>Position of legend, default is "bottom".</p></dd>


<dt>legend_row</dt>
<dd><p>Fiddle with these to widen or narrow your legend.</p></dd>


<dt>legend_col</dt>
<dd><p>Fiddle with these to widen or narrow your legend.</p></dd>


<dt>metadataBarHeight</dt>
<dd><p>Optional argument to adjust the height of
bar with annotations. The default is 1.5.</p></dd>


<dt>metadataBarFontsize</dt>
<dd><p>Optional argument to control for the
font size of metadata annotations. The default is 5.</p></dd>


<dt>legendFontSize</dt>
<dd><p>Font size for legend, default is 10.</p></dd>


<dt>fontSizeGene</dt>
<dd><p>Font size for gene labels (default 6).</p></dd>


<dt>annotation_row</dt>
<dd><p>Row for annotations, default is 2.</p></dd>


<dt>annotation_col</dt>
<dd><p>Column for annotations, default is 1.</p></dd>


<dt>verbose</dt>
<dd><p>Set to TRUE to enable verbose mode (debugging messages.</p></dd>


<dt>cluster_rows</dt>
<dd><p>Force clustering of genes with correlated
mutation patterns</p></dd>


<dt>cluster_cols</dt>
<dd><p>Force clustering of patients with correlated
mutation patterns</p></dd>


<dt>clustering_distance_rows</dt>
<dd><p>Distance metric used for clustering
when cluster_rows = TRUE</p></dd>


<dt>clustering_distance_cols</dt>
<dd><p>Distance metric used for clustering
when cluster_cols = TRUE</p></dd>


<dt>split_rows_kmeans</dt>
<dd><p>K value for k-means clustering on rows</p></dd>


<dt>split_columns_kmeans</dt>
<dd><p>K value for k-means clustering on columns</p></dd>


<dt>dry_run</dt>
<dd><p>Set to TRUE to more efficiently view the clustering
result while debugging cluster_rows/clustering_distance_rows</p></dd>


<dt>simplify_annotation</dt>
<dd><p>Collapse/group the variant effect categories
to only 3 options. This is a much faster option for when many
patients/genes are included.</p></dd>


<dt>simplify_bg_colour</dt>
<dd><p>When simplify_annotation is called, adjust
the color of the background by passign a value to this argument.
Default is NA.</p></dd>


<dt>stacked</dt>
<dd><p>Deprecated. See [GAMBLR.viz::prettyStackedOncoplot]
for this functionality.</p></dd>


<dt>return_inputs</dt>
<dd><p>Optional flag to return the plot and various
other internal objects such as the underlying mutation matrix.</p></dd>


<dt>gap</dt>
<dd><p>Size of gap between columns represented as a proportion
of the full width of the column. Default 0 (no gap).</p></dd>


<dt>use_raster</dt>
<dd><p>Whether to rasterize image</p></dd>


<dt>show_pct</dt>
<dd><p>TRUE by default. Set to FALSE to hide percentage.</p></dd>


<dt>hide_annotation_name</dt>
<dd><p>Default: FALSE</p></dd>


<dt>cluster_numeric_rows</dt>
<dd><p>Deprecated.
See [GAMBLR.viz::prettyStackedOncoplot] for this functionality.</p></dd>


<dt>cluster_numeric_cols</dt>
<dd><p>Deprecated.
See [GAMBLR.viz::prettyStackedOncoplot] for this functionality.</p></dd>


<dt>numeric_heatmap_type</dt>
<dd><p>Deprecated.
See [GAMBLR.viz::prettyStackedOncoplot] for this functionality.</p></dd>


<dt>numeric_heatmap_location</dt>
<dd><p>Deprecated.
See [GAMBLR.viz::prettyStackedOncoplot] for this functionality.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>By default, nothing unless return_inputs is specified,
in which case it returns a named list that contains different
things depending on how the function was run
At the very least, it will contain the Heatmap object a logical
matrix indicating the mutation status of each gene and
patient shown in the output.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Generatss an oncoplot (a.k.a. oncoprint) that is pretty
using ComplexHeatmap. The metadata is expected to follow the structure
and column naming used in GAMBL.
If you provide your own non-GAMBL samples and metadata,
you must include at least the following columns with these names.
The first one should match the Tumor_Sample_Barcode in the MAF
object or onco_matrix you provide.
sample_id, pathology</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># load packages</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GAMBLR</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using GAMBLR.open</span></span></span>
<span class="r-in"><span><span class="va">maf_metadata</span> <span class="op">&lt;-</span> <span class="fu">GAMBLR.open</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GAMBLR.open/man/get_gambl_metadata.html" class="external-link">get_gambl_metadata</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                               seq_type_filter <span class="op">=</span> <span class="st">"genome"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pathology</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FL"</span>, <span class="st">"DLBCL"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="va">study</span> <span class="op">==</span> <span class="st">"FL_Dreval"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">maf_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GAMBLR.open/man/get_coding_ssm.html" class="external-link">get_coding_ssm</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  these_samples_metadata <span class="op">=</span> <span class="va">maf_metadata</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define some genes of interest</span></span></span>
<span class="r-in"><span><span class="va">fl_genes</span> <span class="op">&lt;-</span> <span class="fu">GAMBLR.data</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/GAMBLR.data/man/lymphoma_genes_lymphoma_genes_v0.0.html" class="external-link">lymphoma_genes</a></span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">FL_Tier</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">Gene</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dlbcl_genes</span> <span class="op">&lt;-</span> <span class="fu">GAMBLR.data</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/GAMBLR.data/man/lymphoma_genes_lymphoma_genes_v0.0.html" class="external-link">lymphoma_genes</a></span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">DLBCL_Tier</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">!</span><span class="va">Gene</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">fl_genes</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">Gene</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fl_genes</span>, <span class="va">dlbcl_genes</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For splitting into gene sets</span></span></span>
<span class="r-in"><span><span class="va">split_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"FL"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fl_genes</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"DLBCL"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dlbcl_genes</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">split_genes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">genes</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">prettyOncoplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>  maf_df <span class="op">=</span> <span class="va">maf_data</span>, genes <span class="op">=</span> <span class="va">genes</span>,</span></span>
<span class="r-in"><span>  these_samples_metadata <span class="op">=</span> <span class="va">maf_metadata</span>,</span></span>
<span class="r-in"><span>  splitGeneGroups <span class="op">=</span> <span class="va">split_genes</span>,</span></span>
<span class="r-in"><span>  minMutationPercent <span class="op">=</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="prettyOncoplot-1.png" alt="" width="864" height="864"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Was that too slow for you? Enable the simplify_annotation</span></span></span>
<span class="r-in"><span><span class="co"># parameter for a quicker result.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">prettyOncoplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>  maf_df <span class="op">=</span> <span class="va">maf_data</span>, genes <span class="op">=</span> <span class="va">genes</span>,</span></span>
<span class="r-in"><span>  these_samples_metadata <span class="op">=</span> <span class="va">maf_metadata</span>,</span></span>
<span class="r-in"><span>  splitGeneGroups <span class="op">=</span> <span class="va">split_genes</span>,</span></span>
<span class="r-in"><span>  minMutationPercent <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  simplify_annotation <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="prettyOncoplot-2.png" alt="" width="864" height="864"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Want to include copy number? You have two options.</span></span></span>
<span class="r-in"><span><span class="co"># Option 1:</span></span></span>
<span class="r-in"><span><span class="co"># Incorporate CN status of specific genes into your oncoplot</span></span></span>
<span class="r-in"><span><span class="co"># along with mutations.</span></span></span>
<span class="r-in"><span><span class="co"># There are two ways to go about this.</span></span></span>
<span class="r-in"><span><span class="co"># The original way involves using the helper function get_cnv_and_ssm_status</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gene_regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  gene_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"REL"</span>, <span class="st">"CDKN2A"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"MIR17HG"</span>, <span class="st">"TP53"</span>, <span class="st">"ATM"</span>, <span class="st">"FAS"</span>, <span class="st">"SMARCA4"</span>, <span class="st">"B2M"</span>, <span class="st">"TNFRSF14"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"TMEM30A"</span>, <span class="st">"TNFAIP3"</span>, <span class="st">"BCL2"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  cn_thresh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this data frame specifies the threshold and directionality for</span></span></span>
<span class="r-in"><span><span class="co"># each gene's copy number state to display on the oncoplot.</span></span></span>
<span class="r-in"><span><span class="co"># Amplifications will be shown for REL and MIR17HG, gains</span></span></span>
<span class="r-in"><span><span class="co"># for BCL2, deletions for the rest</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gene_regions</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     gene_id cn_thresh</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       REL         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    CDKN2A         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   MIR17HG         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      TP53         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       ATM         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       FAS         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   SMARCA4         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       B2M         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  TNFRSF14         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  TMEM30A         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  TNFAIP3         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     BCL2         3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gene_cnv</span> <span class="op">&lt;-</span> <span class="fu">get_cnv_and_ssm_status</span><span class="op">(</span></span></span>
<span class="r-in"><span>  only_cnv <span class="op">=</span> <span class="st">"all"</span>,</span></span>
<span class="r-in"><span>  these_samples_metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/GAMBLR.open/man/get_gambl_metadata.html" class="external-link">get_gambl_metadata</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  genes_and_cn_threshs <span class="op">=</span> <span class="va">gene_regions</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">prettyOncoplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>  maf_df <span class="op">=</span> <span class="va">maf_data</span>, genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"CREBBP"</span>, <span class="st">"EZH2"</span>, <span class="st">"MYD88"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"TCF3"</span>, <span class="st">"BCL2"</span>, <span class="st">"BCL7A"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"MEF2B"</span>, <span class="st">"POU2F2"</span>, <span class="st">"POU2AF1"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"ID3"</span>, <span class="st">"MYC"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"RRAGC"</span>, <span class="st">"TCL1A"</span>, <span class="st">"KMT2D"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"PIM1"</span>, <span class="st">"CD79B"</span>, <span class="st">"TMSB4X"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"TMEM30A"</span>, <span class="st">"TNFAIP3"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  these_samples_metadata <span class="op">=</span> <span class="va">maf_metadata</span>,</span></span>
<span class="r-in"><span>  cluster_rows <span class="op">=</span> <span class="cn">T</span>,</span></span>
<span class="r-in"><span>  metadataColumns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"pathology"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"lymphgen"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"seq_type"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"ffpe_or_frozen"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  cluster_cols <span class="op">=</span> <span class="cn">F</span>,</span></span>
<span class="r-in"><span>  simplify_annotation <span class="op">=</span> <span class="cn">T</span>,</span></span>
<span class="r-in"><span>  cnv_df <span class="op">=</span> <span class="va">gene_cnv</span>,</span></span>
<span class="r-in"><span>  sortByColumns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pathology"</span>, <span class="st">"lymphgen"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="prettyOncoplot-3.png" alt="" width="864" height="864"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Option 2:</span></span></span>
<span class="r-in"><span><span class="co"># The second way to incorporate copy number relies</span></span></span>
<span class="r-in"><span><span class="co"># instead on a binned copy number matrix</span></span></span>
<span class="r-in"><span><span class="co"># If you already have one on hand, this is clearly the preferred approach!</span></span></span>
<span class="r-in"><span><span class="co"># First let's make one with the help of segmented_data_to_cn_matrix</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">all_segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GAMBLR.open/man/get_cn_segments.html" class="external-link">get_cn_segments</a></span><span class="op">(</span>these_samples_metadata <span class="op">=</span> <span class="va">maf_metadata</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> dummy segments are not annotated in the inputs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> fill_missing_with parameter will be ignored</span>
<span class="r-in"><span><span class="va">all_states_binned</span> <span class="op">&lt;-</span> <span class="fu">segmented_data_to_cn_matrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  seg_data <span class="op">=</span> <span class="va">all_segments</span>,</span></span>
<span class="r-in"><span>  strategy <span class="op">=</span> <span class="st">"auto_split"</span>,</span></span>
<span class="r-in"><span>  n_bins_split <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>  fill_missing_with <span class="op">=</span> <span class="st">"avg_ploidy"</span>,</span></span>
<span class="r-in"><span>  adjust_for_ploidy <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  these_samples_metadata <span class="op">=</span> <span class="va">maf_metadata</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note: adjust_for_ploidy = TRUE ensures the relative</span></span></span>
<span class="r-in"><span><span class="co"># CN status is used for high-ploidy cases</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># as before, we need to specify which genes we want</span></span></span>
<span class="r-in"><span><span class="co"># CN events shown for and what direction (gain or loss)</span></span></span>
<span class="r-in"><span><span class="co"># This is done a bit more easily with the genes_CN_thresh option.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">CN_thresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"REL"</span> <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  <span class="st">"CDKN2A"</span> <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  <span class="st">"MIR17HG"</span> <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TP53"</span> <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TNFRSF14"</span> <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TNFAIP3"</span> <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">prettyOncoplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>  maf_df <span class="op">=</span> <span class="va">maf_data</span>,</span></span>
<span class="r-in"><span>  binned_cnv_df <span class="op">=</span> <span class="va">all_states_binned</span>,</span></span>
<span class="r-in"><span>  genes_CN_thresh <span class="op">=</span> <span class="va">CN_thresh</span>,</span></span>
<span class="r-in"><span>  genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">genes</span>, <span class="fl">25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  these_samples_metadata <span class="op">=</span> <span class="va">maf_metadata</span>,</span></span>
<span class="r-in"><span>  cluster_rows <span class="op">=</span> <span class="cn">T</span>,</span></span>
<span class="r-in"><span>  metadataColumns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"pathology"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"genetic_subgroup"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"seq_type"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"ffpe_or_frozen"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  cluster_cols <span class="op">=</span> <span class="cn">F</span>,</span></span>
<span class="r-in"><span>  simplify_annotation <span class="op">=</span> <span class="cn">T</span>,</span></span>
<span class="r-in"><span>  sortByColumns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pathology"</span>, <span class="st">"genetic_subgroup"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  minMutationPercent <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="prettyOncoplot-4.png" alt="" width="864" height="864"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ryan Morin, Kostiantyn Dreval, Laura Hilton, Adam Mattsson, Vladimir Souza.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

